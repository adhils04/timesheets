/*! For license information please see 450.cdb0f4a4.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunktimesheets=self.webpackChunktimesheets||[]).push([[450],{11(e,t,r){r.d(t,{V:()=>l});r(43);var n=r(784);const s=(0,n.A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),a=(0,n.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var i=r(217),o=r(579);const l=e=>{let{selectedFounder:t,setSelectedFounder:r,title:n}=e;return(0,o.jsxs)("header",{className:"top-bar",children:[(0,o.jsxs)("div",{className:"page-title",children:[(0,o.jsx)("h1",{children:n}),(0,o.jsx)("span",{className:"date-display",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,o.jsxs)("div",{className:"founder-selector-container",children:[(0,o.jsx)(s,{size:18,style:{color:"var(--text-muted)",marginRight:"0.5rem"}}),(0,o.jsx)("select",{value:t,onChange:e=>r(e.target.value),className:"founder-select",children:i.$h.map(e=>(0,o.jsx)("option",{value:e,children:e},e))}),(0,o.jsx)(a,{size:14,style:{marginLeft:"0.5rem",opacity:.5}})]})]})}},21(e,t,r){r.d(t,{Ek:()=>d,J3:()=>u,LF:()=>m,vD:()=>h});var n=r(555),s=r(43),a=r(667),i=r(791),o=r(217),l=r(320);const c=()=>(0,a.rJ)(i.db,"artifacts",o.sZ,"public","data",o.LL),d=(e,t)=>{const[r,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{if(!e)return i(null),void l(!1);const r=(0,a.P)(c(),(0,a._M)("founder","==",t),(0,a._M)("endTime","==",null),(0,a.AB)(1)),s=(0,a.aQ)(r,e=>{let t=null;if(!e.empty){var r;const s=e.docs[0];t=(0,n.A)((0,n.A)({id:s.id},s.data()),{},{startTime:null===(r=s.data().startTime)||void 0===r?void 0:r.toDate()})}i(t),l(!1)},e=>{console.error("Active entry error:",e),l(!1)});return()=>s()},[e,t]),{activeEntry:r,loading:o}},m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const r=(0,l.hi)(l._l.RECENT_ENTRIES),[i,o]=(0,s.useState)(r||[]),[d,m]=(0,s.useState)(!r);return(0,s.useEffect)(()=>{if(!e)return o([]),void m(!1);const s=(0,a.P)(c(),(0,a.My)("startTime","desc"),(0,a.AB)(t)),i=e=>{const t=e.docs.map(e=>{var t,r,s,a;const i=e.data({serverTimestamps:"estimate"});return(0,n.A)((0,n.A)({id:e.id},i),{},{startTime:null===(t=i.startTime)||void 0===t||null===(r=t.toDate())||void 0===r?void 0:r.toISOString(),endTime:null===(s=i.endTime)||void 0===s||null===(a=s.toDate())||void 0===a?void 0:a.toISOString()})}),r=t.map(e=>(0,n.A)((0,n.A)({},e),{},{startTime:e.startTime?new Date(e.startTime):null,endTime:e.endTime?new Date(e.endTime):null}));o(r),m(!1),(0,l.H$)(l._l.RECENT_ENTRIES,t)};r||(0,a.GG)(s).then(e=>{i(e)}).catch(e=>{console.error("Recent entries error:",e),m(!1)});const d=(0,a.aQ)(s,i,e=>{console.error("Recent entries snapshot error:",e)});return()=>d()},[e,t,r]),{entries:i,loading:d}},u=e=>{const t=(0,l.hi)(l._l.STATS),[r,n]=(0,s.useState)(t||{monthTotal:0,yearTotal:0,founderStats:{},activeCount:0}),[i,o]=(0,s.useState)(!t),d=(0,s.useRef)(!!t);return(0,s.useEffect)(()=>{if(!e)return void o(!1);const r=new Date,s=new Date(r.getFullYear(),r.getMonth(),1),i=new Date(r.getFullYear(),0,1),m=s.getTime(),u=e=>{let t=0,r=0,n=0;const s={};return e.forEach(e=>{var a,i;const o=e.data(),l=o.founder;if(!l)return;if(s[l]||(s[l]={month:0,year:0}),!o.endTime)return void n++;const c=null!==(a=o.startTime)&&void 0!==a&&a.seconds?1e3*o.startTime.seconds:0,d=(null!==(i=o.endTime)&&void 0!==i&&i.seconds?1e3*o.endTime.seconds:0)-c;r+=d,s[l].year+=d,c>=m&&(t+=d,s[l].month+=d)}),{monthTotal:t,yearTotal:r,founderStats:s,activeCount:n}},h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=[(0,a._M)("startTime",">=",a.Dc.fromDate(e))];return t&&r.push((0,a._M)("startTime","<",a.Dc.fromDate(t))),(0,a.P)(c(),...r)}(i),T=e=>{n(e),o(!1),d.current=!0,(0,l.H$)(l._l.STATS,e)};t||(0,a.GG)(h).then(e=>{T(u(e.docs))}).catch(e=>{console.error("Stats getDocs error:",e),o(!1)});const v=(0,a.aQ)(h,e=>{T(u(e.docs))},e=>{console.error("Stats snapshot error:",e)});return()=>v()},[e,t]),{stats:r,loading:i}},h=e=>{const t=(0,l.hi)("timesheets_all"),[r,i]=(0,s.useState)(()=>t?t.map(e=>(0,n.A)((0,n.A)({},e),{},{startTime:e.startTime?new Date(e.startTime):null,endTime:e.endTime?new Date(e.endTime):null})):[]),[o,d]=(0,s.useState)(!t),[m,u]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(!e)return i([]),void d(!1);const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e.docs.map(e=>{var t,r,s,a;const i=e.data({serverTimestamps:"estimate"});return(0,n.A)((0,n.A)({id:e.id},i),{},{startTime:null===(t=i.startTime)||void 0===t||null===(r=t.toDate())||void 0===r?void 0:r.toISOString(),endTime:null===(s=i.endTime)||void 0===s||null===(a=s.toDate())||void 0===a?void 0:a.toISOString()})}),s=r.map(e=>(0,n.A)((0,n.A)({},e),{},{startTime:e.startTime?new Date(e.startTime):null,endTime:e.endTime?new Date(e.endTime):null}));i(s),d(!1),t?50===r.length&&u(!0):(u(!1),(0,l.H$)("timesheets_all",r))};if(!t){const e=(0,a.P)(c(),(0,a.My)("startTime","desc"),(0,a.AB)(50));(0,a.GG)(e).then(e=>{r(e,!0)}).catch(e=>{console.error("Timesheets getDocs error:",e),d(!1)})}const s=(0,a.P)(c(),(0,a.My)("startTime","desc")),o=(0,a.aQ)(s,e=>{r(e,!1)});return()=>o()},[e,t]),{entries:r,loading:o,loadingMore:m}}},320(e,t,r){r.d(t,{H$:()=>a,_l:()=>o,hi:()=>s});const n="foundertrack_",s=e=>{try{const t=localStorage.getItem(n+e);if(!t)return null;const{data:r,timestamp:s}=JSON.parse(t);return Date.now()-s>864e5?(localStorage.removeItem(n+e),null):r}catch(t){return console.warn("Cache read error:",t),null}},a=(e,t)=>{try{const r={data:t,timestamp:Date.now()};localStorage.setItem(n+e,JSON.stringify(r))}catch(r){console.warn("Cache write error:",r),i()}},i=()=>{try{const e=Object.keys(localStorage),t=e.filter(e=>e.startsWith(n)).map(e=>{try{const t=JSON.parse(localStorage.getItem(e));return{key:e,timestamp:(null===t||void 0===t?void 0:t.timestamp)||0}}catch(t){return{key:e,timestamp:0}}});t.sort((e,t)=>e.timestamp-t.timestamp);t.slice(0,Math.ceil(t.length/2)).forEach(e=>localStorage.removeItem(e.key))}catch(e){console.warn("Old cache clear error:",e)}},o={STATS:"dashboard_stats",RECENT_ENTRIES:"recent_entries",MEETING_STATS:"meeting_stats",ATTENDANCE_PREFIX:"attendance_"}},450(e,t,r){r.d(t,{Timesheets:()=>h});var n=r(43),s=r(978),a=r(855),i=r(667),o=r(791),l=r(21),c=r(11),d=r(217),m=r(829),u=r(579);const h=e=>{let{user:t}=e;const[r,h]=(0,n.useState)(d.$h[0]),{entries:T,loading:v,loadingMore:g}=(0,l.vD)(t);return v?(0,u.jsx)("div",{children:"Loading..."}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c.V,{selectedFounder:r,setSelectedFounder:h,title:"Timesheet History"}),(0,u.jsxs)("div",{className:"card history-section",style:{marginTop:"2rem"},children:[(0,u.jsxs)("h3",{style:{fontSize:"1.1rem",margin:"0 0 1.5rem 0",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,u.jsx)(s.A,{size:20})," All Entries (Year To Date)",g&&(0,u.jsx)("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",fontWeight:400},children:"(Loading older entries...)"})]}),0===T.length?(0,u.jsx)("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:"No activities recorded yet."}):(0,u.jsx)("ul",{className:"history-list",children:T.filter(e=>e.founder===r).map(e=>{const t=e.endTime?(0,m.a3)(e.endTime-e.startTime):"Active",r=(0,m.IM)(e.founder),n=["#4361ee","#7209b7","#f72585","#4cc9f0"][d.$h.indexOf(e.founder)%4];return(0,u.jsxs)("li",{className:"history-item",children:[(0,u.jsx)("div",{className:"history-avatar",style:{background:"".concat(n,"20"),color:n},children:r}),(0,u.jsxs)("div",{className:"history-content",children:[(0,u.jsx)("div",{className:"history-task",children:e.task}),(0,u.jsxs)("div",{className:"history-meta",children:[(0,u.jsx)("span",{children:e.founder}),(0,u.jsx)("span",{children:"\u2022"}),(0,u.jsx)("span",{children:(0,m.Yq)(e.startTime)}),(0,u.jsx)("span",{children:"\u2022"}),(0,u.jsxs)("span",{children:[e.startTime&&e.startTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",e.endTime?e.endTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Now"]})]})]}),(0,u.jsx)("span",{className:"history-duration",style:e.endTime?{}:{color:"#10b981",background:"#d1fae5"},children:t}),(0,u.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this entry?"))try{await(0,i.kd)((0,i.H9)(o.db,"artifacts",d.sZ,"public","data",d.LL,e))}catch(t){console.error("Error deleting:",t)}})(e.id),className:"history-delete-btn",title:"Delete",children:(0,u.jsx)(a.A,{size:16})})]},e.id)})})]})]})}},829(e,t,r){r.d(t,{IM:()=>a,Yq:()=>s,a3:()=>n});const n=e=>{if(!e&&0!==e)return"0h 0m";const t=Math.floor(e/6e4);if(0===t)return"< 1m";const r=Math.floor(t/60),n=t%60;return"".concat(r,"h ").concat(n,"m")},s=e=>e?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(e):"",a=e=>e?e.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?"},855(e,t,r){r.d(t,{A:()=>n});const n=(0,r(784).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])}}]);
//# sourceMappingURL=450.cdb0f4a4.chunk.js.map