/*! For license information please see 335.6212d426.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunktimesheets=self.webpackChunktimesheets||[]).push([[335],{11(e,t,a){a.d(t,{V:()=>o});a(43);var s=a(784);const n=(0,s.A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),r=(0,s.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var i=a(579);const o=e=>{let{selectedFounder:t,setSelectedFounder:a,title:s,foundersList:o=[]}=e;const l=s.startsWith("Welcome")?"".concat((()=>{const e=(new Date).getHours();return e<12?"Good morning":e<18?"Good afternoon":"Good evening"})(),", ").concat(s.replace("Welcome, ","")):s;return(0,i.jsxs)("header",{className:"top-bar",children:[(0,i.jsxs)("div",{className:"page-title",children:[(0,i.jsx)("h1",{children:l}),(0,i.jsx)("span",{className:"date-display",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),a&&(0,i.jsxs)("div",{className:"founder-selector-container",children:[(0,i.jsx)(n,{size:18,style:{color:"var(--text-muted)",marginRight:"0.5rem"}}),(0,i.jsxs)("select",{value:t,onChange:e=>a(e.target.value),className:"founder-select",children:[o.map(e=>(0,i.jsx)("option",{value:e,children:e},e)),0===o.length&&(0,i.jsx)("option",{children:t})]}),(0,i.jsx)(r,{size:14,style:{marginLeft:"0.5rem",opacity:.5}})]})]})}},21(e,t,a){a.d(t,{Ek:()=>c,J3:()=>m,LF:()=>d,vD:()=>u});var s=a(555),n=a(43),r=a(667),i=a(791),o=a(217);const l=()=>(0,r.rJ)(i.db,"artifacts",o.sZ,"public","data",o.LL),c=(e,t)=>{const[a,i]=(0,n.useState)(null),[o,c]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{if(!e)return i(null),void c(!1);const a=setTimeout(()=>{c(!1)},3e3),n=(0,r.P)(l(),(0,r._M)("founder","==",t),(0,r._M)("endTime","==",null),(0,r.AB)(1)),o=(0,r.aQ)(n,e=>{clearTimeout(a);let t=null;if(!e.empty){var n;const a=e.docs[0];t=(0,s.A)((0,s.A)({id:a.id},a.data()),{},{startTime:null===(n=a.data().startTime)||void 0===n?void 0:n.toDate()})}i(t),c(!1)},e=>{console.error("Active entry error:",e),"failed-precondition"===e.code&&console.error("\ud83d\udd25 MISSING INDEX: Open this link to fix ->",e.message),c(!1)});return()=>{o(),clearTimeout(a)}},[e,t]),{activeEntry:a,loading:o}},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const[a,i]=(0,n.useState)([]),[o,c]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{if(!e)return i([]),void c(!1);const a=setTimeout(()=>{c(!1)},3e3),n=(0,r.P)(l(),(0,r.My)("startTime","desc"),(0,r.AB)(t)),o=(0,r.aQ)(n,e=>{clearTimeout(a);const t=e.docs.map(e=>{var t,a;return(0,s.A)((0,s.A)({id:e.id},e.data({serverTimestamps:"estimate"})),{},{startTime:null===(t=e.data({serverTimestamps:"estimate"}).startTime)||void 0===t?void 0:t.toDate(),endTime:null===(a=e.data({serverTimestamps:"estimate"}).endTime)||void 0===a?void 0:a.toDate()})});i(t),c(!1)},e=>{console.error("Recent entries error:",e),"failed-precondition"===e.code&&console.warn("\ud83d\udd25 MISSING INDEX for Recent Entries. Check console for link."),c(!1)});return()=>{o(),clearTimeout(a)}},[e,t]),{entries:a,loading:o}},m=e=>{const[t,a]=(0,n.useState)({monthTotal:0,yearTotal:0,founderStats:{},activeCount:0}),[s,l]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{if(!e)return void l(!1);const t=setTimeout(()=>{l(!1)},3e3),s=(0,r.H9)(i.db,"artifacts",o.sZ,"public","data","stats","aggregate"),n=(0,r.aQ)(s,e=>{if(clearTimeout(t),e.exists()){const t=e.data();a(t)}else console.warn("Stats document doesn't exist. Please ensure write operations update aggregates."),a({monthTotal:0,yearTotal:0,founderStats:{},activeCount:0});l(!1)},e=>{console.error("Stats snapshot error:",e),l(!1)});return()=>{n(),clearTimeout(t)}},[e]),{stats:t,loading:s}},u=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[a,i]=(0,n.useState)([]),[o,c]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{if(!e&&!t)return i([]),void c(!1);const a=(0,r.P)(l(),(0,r.My)("startTime","desc"),(0,r.AB)(100)),n=(0,r.aQ)(a,e=>{const t=e.docs.map(e=>{var t,a;return(0,s.A)((0,s.A)({id:e.id},e.data({serverTimestamps:"estimate"})),{},{startTime:null===(t=e.data({serverTimestamps:"estimate"}).startTime)||void 0===t?void 0:t.toDate(),endTime:null===(a=e.data({serverTimestamps:"estimate"}).endTime)||void 0===a?void 0:a.toDate()})});i(t),c(!1)},e=>{console.error("Timesheets snapshot error:",e),c(!1)});return()=>n()},[e]),{entries:a,loading:o}}},335(e,t,a){a.d(t,{Timesheets:()=>y});var s=a(43),n=a(784);const r=(0,n.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),i=(0,n.A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var o=a(978),l=a(855),c=a(505),d=a(667),m=a(791),u=a(21),h=a(11),p=a(217),f=a(829),v=a(380),g=a(579);const y=e=>{let{user:t,forcedFounder:a,isAdmin:n}=e;const[y,T]=(0,s.useState)(a||p.$h[0]),[x,j]=(0,s.useState)(""),[b,k]=(0,s.useState)("all"),[N,D]=(0,s.useState)({}),[S,w]=(0,s.useState)(null),{entries:A,loading:C}=(0,u.vD)(t,n);(0,s.useEffect)(()=>{(async()=>{if(n)try{const e=await(0,d.GG)((0,d.rJ)(m.db,"artifacts",p.sZ,"users")),t={};e.forEach(e=>{const a=e.data();a.fullName&&a.role&&(t[a.fullName]=a.role)}),D(t)}catch(e){console.error("Error fetching user roles:",e)}})()},[n]);const E=async(e,t,a)=>{try{const s=(0,d.H9)(m.db,"artifacts",p.sZ,"public","data","stats","aggregate"),n=new Date,r=a||n,i=r.getMonth()===n.getMonth()&&r.getFullYear()===n.getFullYear(),o=r.getFullYear()===n.getFullYear(),l={year:(0,d.GV)(t)};i&&(l.month=(0,d.GV)(t));const c={founderStats:{[e]:l}};o&&(c.yearTotal=(0,d.GV)(t)),i&&(c.monthTotal=(0,d.GV)(t)),await(0,d.BN)(s,c,{merge:!0})}catch(s){console.error("Failed to update stats:",s)}},M=async e=>{if(window.confirm("Are you sure you want to delete this entry?"))try{const t=(0,d.H9)(m.db,"artifacts",p.sZ,"public","data",p.LL,e),a=await(0,d.x7)(t);if(a.exists()){const e=a.data();if(e.endTime&&"active"!==e.status){if(e.endTime&&e.startTime){const t=e.startTime.toDate?e.startTime.toDate():new Date(e.startTime),a=(e.endTime.toDate?e.endTime.toDate():new Date(e.endTime)).getTime()-t.getTime();await E(e.founder,-a,t)}}else await(async e=>{try{const t=(0,d.H9)(m.db,"artifacts",p.sZ,"public","data","stats","aggregate");await(0,d.BN)(t,{activeCount:(0,d.GV)(e)},{merge:!0})}catch(t){console.error(t)}})(-1)}await(0,d.kd)(t)}catch(t){console.error("Error deleting:",t)}};if(C)return(0,g.jsx)("div",{children:"Loading..."});let L=n?A.filter(e=>e.founder.toLowerCase().includes(x.toLowerCase())):A.filter(e=>e.founder===y);return n&&"all"!==b&&(L=L.filter(e=>{const t=N[e.founder];return t?t===b:p.$h.includes(e.founder)?"founder"===b:"employee"===b})),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(h.V,{selectedFounder:y,setSelectedFounder:a||n?void 0:T,title:n?"Admin Timesheets":a?"My Timesheet History":"Timesheet History",foundersList:n?[]:a?[a]:p.$h}),n&&(0,g.jsxs)("div",{style:{marginTop:"2rem",marginBottom:"1rem",display:"flex",gap:"1rem",flexWrap:"wrap"},children:[(0,g.jsxs)("div",{style:{position:"relative",flex:1,minWidth:"200px",maxWidth:"400px"},children:[(0,g.jsx)(r,{size:20,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),(0,g.jsx)("input",{type:"text",placeholder:"Search by name...",value:x,onChange:e=>j(e.target.value),className:"custom-input",style:{paddingLeft:"2.5rem",width:"100%"}})]}),(0,g.jsxs)("div",{style:{position:"relative",minWidth:"150px"},children:[(0,g.jsx)(i,{size:18,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),(0,g.jsxs)("select",{value:b,onChange:e=>k(e.target.value),className:"custom-input",style:{paddingLeft:"2.5rem",width:"100%",cursor:"pointer",appearance:"none"},children:[(0,g.jsx)("option",{value:"all",children:"All Roles"}),(0,g.jsx)("option",{value:"founder",children:"Founders"}),(0,g.jsx)("option",{value:"employee",children:"Employees"})]})]})]}),(0,g.jsxs)("div",{className:"card history-section",style:{marginTop:"2rem"},children:[(0,g.jsxs)("h3",{style:{fontSize:"1.1rem",margin:"0 0 1.5rem 0",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,g.jsx)(o.A,{size:20})," ",n?"All Entries (".concat(L.length,")"):"All Entries (Year To Date)"]}),0===L.length?(0,g.jsx)("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:n?"No matching records found.":"No activities recorded yet."}):(0,g.jsx)("ul",{className:"history-list",children:L.map(e=>{const t=e.startTime,a=e.endTime;let s="Active";a&&t&&(s=(0,f.a3)(a-t));const n=(0,f.IM)(e.founder),r=p.$h.indexOf(e.founder)%4,i=["#4361ee","#7209b7","#f72585","#4cc9f0"],o=i[Math.max(0,r)]||i[0];return(0,g.jsxs)("li",{className:"history-item",children:[(0,g.jsx)("div",{className:"history-avatar",style:{background:"".concat(o,"20"),color:o},children:n}),(0,g.jsxs)("div",{className:"history-content",children:[(0,g.jsx)("div",{className:"history-task",children:e.task}),(0,g.jsxs)("div",{className:"history-meta",children:[(0,g.jsx)("span",{children:e.founder}),(0,g.jsx)("span",{children:"\u2022"}),(0,g.jsx)("span",{children:t?(0,f.Yq)(t):"Unknown Date"}),(0,g.jsx)("span",{children:"\u2022"}),(0,g.jsxs)("span",{children:[t?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"," -",a?a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Now"]})]})]}),(0,g.jsx)("span",{className:"history-duration",style:a?{}:{color:"#10b981",background:"#d1fae5"},children:s}),(0,g.jsx)("button",{onClick:()=>M(e.id),className:"history-delete-btn",title:"Delete",children:(0,g.jsx)(l.A,{size:16})}),(0,g.jsx)("button",{onClick:()=>w(e),className:"history-edit-btn",title:"Edit",children:(0,g.jsx)(c.A,{size:16})})]},e.id)})})]}),(0,g.jsx)(v.E,{entry:S,onSave:async e=>{try{const t=S;if(!t)return;const a=(0,d.H9)(m.db,"artifacts",p.sZ,"public","data",p.LL,e.id),s=t.startTime.toDate?t.startTime.toDate():new Date(t.startTime),n=t.endTime?t.endTime.toDate?t.endTime.toDate():new Date(t.endTime):null;if(n){const e=n.getTime()-s.getTime();await E(t.founder,-e,s)}const r=e.endTime.getTime()-e.startTime.getTime();await E(e.founder,r,e.startTime),await(0,d.mZ)(a,{task:e.task,startTime:d.Dc.fromDate(e.startTime),endTime:d.Dc.fromDate(e.endTime)}),w(null)}catch(t){console.error("Error updating entry:",t),alert("Failed to update entry")}},onCancel:()=>w(null)})]})}},380(e,t,a){a.d(t,{E:()=>o});var s=a(555),n=a(43);const r=(0,a(784).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var i=a(579);const o=e=>{let{entry:t,onSave:a,onCancel:o}=e;const[l,c]=(0,n.useState)(""),[d,m]=(0,n.useState)(""),[u,h]=(0,n.useState)(""),[p,f]=(0,n.useState)("");(0,n.useEffect)(()=>{if(t){c(t.task);const e=t.startTime&&t.startTime.toDate?t.startTime.toDate():new Date(t.startTime),a=t.endTime&&t.endTime.toDate?t.endTime.toDate():new Date(t.endTime);e&&(m(e.toTimeString().slice(0,5)),f(e.toISOString().split("T")[0])),a&&h(a.toTimeString().slice(0,5))}},[t]);return t?(0,i.jsx)("div",{className:"modal-overlay",onClick:o,children:(0,i.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsx)("h3",{className:"modal-title",children:"Edit Entry"}),(0,i.jsx)("button",{className:"mode-switch-btn",onClick:o,style:{padding:"0.25rem"},children:(0,i.jsx)(r,{size:20})})]}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault();const n=new Date("".concat(p,"T").concat(d)),r=new Date("".concat(p,"T").concat(u));r<=n?alert("End time must be after start time"):a((0,s.A)((0,s.A)({},t),{},{task:l,startTime:n,endTime:r}))},children:[(0,i.jsxs)("div",{className:"input-group",children:[(0,i.jsx)("label",{className:"input-label",children:"Task Description"}),(0,i.jsx)("input",{type:"text",className:"custom-input",value:l,onChange:e=>c(e.target.value),required:!0})]}),(0,i.jsxs)("div",{className:"input-group",children:[(0,i.jsx)("label",{className:"input-label",children:"Date"}),(0,i.jsx)("input",{type:"date",className:"custom-input",value:p,onChange:e=>f(e.target.value),required:!0})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,i.jsxs)("div",{className:"input-group",children:[(0,i.jsx)("label",{className:"input-label",children:"Start Time"}),(0,i.jsx)("input",{type:"time",className:"custom-input",value:d,onChange:e=>m(e.target.value),required:!0})]}),(0,i.jsxs)("div",{className:"input-group",children:[(0,i.jsx)("label",{className:"input-label",children:"End Time"}),(0,i.jsx)("input",{type:"time",className:"custom-input",value:u,onChange:e=>h(e.target.value),required:!0})]})]}),(0,i.jsxs)("div",{className:"modal-actions",children:[(0,i.jsx)("button",{type:"button",className:"action-btn",onClick:o,style:{padding:"0.75rem 1.5rem",background:"#f1f5f9",color:"#64748b"},children:"Cancel"}),(0,i.jsx)("button",{type:"submit",className:"action-btn btn-primary",style:{padding:"0.75rem 1.5rem"},children:"Save Changes"})]})]})]})}):null}},505(e,t,a){a.d(t,{A:()=>s});const s=(0,a(784).A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]])},829(e,t,a){a.d(t,{IM:()=>r,Yq:()=>n,a3:()=>s});const s=e=>{if(!e&&0!==e)return"0h 0m";const t=Math.floor(e/6e4);if(0===t)return"< 1m";const a=Math.floor(t/60),s=t%60;return"".concat(a,"h ").concat(s,"m")},n=e=>e?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(e):"",r=e=>e?e.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?"},855(e,t,a){a.d(t,{A:()=>s});const s=(0,a(784).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])}}]);
//# sourceMappingURL=335.6212d426.chunk.js.map