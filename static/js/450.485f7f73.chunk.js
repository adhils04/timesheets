/*! For license information please see 450.485f7f73.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunktimesheets=self.webpackChunktimesheets||[]).push([[450],{11(e,t,s){s.d(t,{V:()=>d});s(43);var a=s(784);const r=(0,a.A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),i=(0,a.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var n=s(217),o=s(579);const d=e=>{let{selectedFounder:t,setSelectedFounder:s,title:a}=e;return(0,o.jsxs)("header",{className:"top-bar",children:[(0,o.jsxs)("div",{className:"page-title",children:[(0,o.jsx)("h1",{children:a}),(0,o.jsx)("span",{className:"date-display",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,o.jsxs)("div",{className:"founder-selector-container",children:[(0,o.jsx)(r,{size:18,style:{color:"var(--text-muted)",marginRight:"0.5rem"}}),(0,o.jsx)("select",{value:t,onChange:e=>s(e.target.value),className:"founder-select",children:n.$h.map(e=>(0,o.jsx)("option",{value:e,children:e},e))}),(0,o.jsx)(i,{size:14,style:{marginLeft:"0.5rem",opacity:.5}})]})]})}},21(e,t,s){s.d(t,{Ek:()=>c,J3:()=>m,LF:()=>l,vD:()=>u});var a=s(555),r=s(43),i=s(667),n=s(791),o=s(217);const d=()=>(0,i.rJ)(n.db,"artifacts",o.sZ,"public","data",o.LL),c=(e,t)=>{const[s,n]=(0,r.useState)(null),[o,c]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{if(!e)return n(null),void c(!1);const s=(0,i.P)(d(),(0,i._M)("founder","==",t),(0,i._M)("endTime","==",null),(0,i.AB)(1)),r=(0,i.aQ)(s,e=>{let t=null;if(!e.empty){var s;const r=e.docs[0];t=(0,a.A)((0,a.A)({id:r.id},r.data()),{},{startTime:null===(s=r.data().startTime)||void 0===s?void 0:s.toDate()})}n(t),c(!1)},e=>{console.error("Active entry error:",e),c(!1)});return()=>r()},[e,t]),{activeEntry:s,loading:o}},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const[s,n]=(0,r.useState)([]),[o,c]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{if(!e)return n([]),void c(!1);const s=(0,i.P)(d(),(0,i.My)("startTime","desc"),(0,i.AB)(t)),r=(0,i.aQ)(s,e=>{const t=e.docs.map(e=>{var t,s;return(0,a.A)((0,a.A)({id:e.id},e.data({serverTimestamps:"estimate"})),{},{startTime:null===(t=e.data({serverTimestamps:"estimate"}).startTime)||void 0===t?void 0:t.toDate(),endTime:null===(s=e.data({serverTimestamps:"estimate"}).endTime)||void 0===s?void 0:s.toDate()})});n(t),c(!1)},e=>{console.error("Recent entries error:",e),c(!1)});return()=>r()},[e,t]),{entries:s,loading:o}},m=e=>{const[t,s]=(0,r.useState)({monthTotal:0,yearTotal:0,founderStats:{},activeCount:0}),[a,c]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{if(!e)return void c(!1);const t=(0,i.H9)(n.db,"artifacts",o.sZ,"public","data","stats","aggregate"),a=(0,i.aQ)(t,async e=>{if(e.exists())s(e.data()),c(!1);else{console.log("Stats document missing. performing one-time migration...");const e=new Date,a=new Date(e.getFullYear(),e.getMonth(),1).getTime(),r=(0,i.P)(d()),n=await(0,i.GG)(r);let o=0,l=0,m=0;const u={};n.docs.forEach(e=>{var t,s;const r=e.data(),i=r.founder;if(!i)return;if(u[i]||(u[i]={month:0,year:0}),!r.endTime)return void m++;const n=null!==(t=r.startTime)&&void 0!==t&&t.seconds?1e3*r.startTime.seconds:0,d=(null!==(s=r.endTime)&&void 0!==s&&s.seconds?1e3*r.endTime.seconds:0)-n;l+=d,u[i].year+=d,n>=a&&(o+=d,u[i].month+=d)});const h={monthTotal:o,yearTotal:l,founderStats:u,activeCount:m};await(0,i.BN)(t,h),s(h),c(!1)}},e=>{console.error("Stats snapshot error:",e),c(!1)});return()=>a()},[e]),{stats:t,loading:a}},u=e=>{const[t,s]=(0,r.useState)([]),[n,o]=(0,r.useState)(!0),[c,l]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(!e)return s([]),void o(!1);const t=(0,i.P)(d(),(0,i.My)("startTime","desc"),(0,i.AB)(50));(0,i.GG)(t).then(e=>{const t=e.docs.map(e=>{var t,s;return(0,a.A)((0,a.A)({id:e.id},e.data({serverTimestamps:"estimate"})),{},{startTime:null===(t=e.data({serverTimestamps:"estimate"}).startTime)||void 0===t?void 0:t.toDate(),endTime:null===(s=e.data({serverTimestamps:"estimate"}).endTime)||void 0===s?void 0:s.toDate()})});s(t),o(!1),50===t.length&&l(!0)}).catch(e=>{console.error("Timesheets getDocs error:",e),o(!1)});const r=(0,i.P)(d(),(0,i.My)("startTime","desc"),(0,i.AB)(100)),n=(0,i.aQ)(r,e=>{const t=e.docs.map(e=>{var t,s;return(0,a.A)((0,a.A)({id:e.id},e.data({serverTimestamps:"estimate"})),{},{startTime:null===(t=e.data({serverTimestamps:"estimate"}).startTime)||void 0===t?void 0:t.toDate(),endTime:null===(s=e.data({serverTimestamps:"estimate"}).endTime)||void 0===s?void 0:s.toDate()})});s(t),l(!1)});return()=>n()},[e]),{entries:t,loading:n,loadingMore:c}}},450(e,t,s){s.d(t,{Timesheets:()=>h});var a=s(43),r=s(978),i=s(855),n=s(667),o=s(791),d=s(21),c=s(11),l=s(217),m=s(829),u=s(579);const h=e=>{let{user:t}=e;const[s,h]=(0,a.useState)(l.$h[0]),{entries:v,loading:y,loadingMore:T}=(0,d.vD)(t);return y?(0,u.jsx)("div",{children:"Loading..."}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c.V,{selectedFounder:s,setSelectedFounder:h,title:"Timesheet History"}),(0,u.jsxs)("div",{className:"card history-section",style:{marginTop:"2rem"},children:[(0,u.jsxs)("h3",{style:{fontSize:"1.1rem",margin:"0 0 1.5rem 0",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,u.jsx)(r.A,{size:20})," All Entries (Year To Date)",T&&(0,u.jsx)("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",fontWeight:400},children:"(Loading older entries...)"})]}),0===v.length?(0,u.jsx)("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:"No activities recorded yet."}):(0,u.jsx)("ul",{className:"history-list",children:v.filter(e=>e.founder===s).map(e=>{const t=e.endTime?(0,m.a3)(e.endTime-e.startTime):"Active",s=(0,m.IM)(e.founder),a=["#4361ee","#7209b7","#f72585","#4cc9f0"][l.$h.indexOf(e.founder)%4];return(0,u.jsxs)("li",{className:"history-item",children:[(0,u.jsx)("div",{className:"history-avatar",style:{background:"".concat(a,"20"),color:a},children:s}),(0,u.jsxs)("div",{className:"history-content",children:[(0,u.jsx)("div",{className:"history-task",children:e.task}),(0,u.jsxs)("div",{className:"history-meta",children:[(0,u.jsx)("span",{children:e.founder}),(0,u.jsx)("span",{children:"\u2022"}),(0,u.jsx)("span",{children:(0,m.Yq)(e.startTime)}),(0,u.jsx)("span",{children:"\u2022"}),(0,u.jsxs)("span",{children:[e.startTime&&e.startTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",e.endTime?e.endTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Now"]})]})]}),(0,u.jsx)("span",{className:"history-duration",style:e.endTime?{}:{color:"#10b981",background:"#d1fae5"},children:t}),(0,u.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this entry?"))try{await(0,n.kd)((0,n.H9)(o.db,"artifacts",l.sZ,"public","data",l.LL,e))}catch(t){console.error("Error deleting:",t)}})(e.id),className:"history-delete-btn",title:"Delete",children:(0,u.jsx)(i.A,{size:16})})]},e.id)})})]})]})}},829(e,t,s){s.d(t,{IM:()=>i,Yq:()=>r,a3:()=>a});const a=e=>{if(!e&&0!==e)return"0h 0m";const t=Math.floor(e/6e4);if(0===t)return"< 1m";const s=Math.floor(t/60),a=t%60;return"".concat(s,"h ").concat(a,"m")},r=e=>e?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(e):"",i=e=>e?e.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?"},855(e,t,s){s.d(t,{A:()=>a});const a=(0,s(784).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])}}]);
//# sourceMappingURL=450.485f7f73.chunk.js.map