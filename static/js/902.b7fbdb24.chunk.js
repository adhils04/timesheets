/*! For license information please see 902.b7fbdb24.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunktimesheets=self.webpackChunktimesheets||[]).push([[902],{11(e,t,a){a.d(t,{V:()=>o});a(43);var r=a(784);const s=(0,r.A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),n=(0,r.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var i=a(217),l=a(579);const o=e=>{let{selectedFounder:t,setSelectedFounder:a,title:r}=e;return(0,l.jsxs)("header",{className:"top-bar",children:[(0,l.jsxs)("div",{className:"page-title",children:[(0,l.jsx)("h1",{children:r}),(0,l.jsx)("span",{className:"date-display",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,l.jsxs)("div",{className:"founder-selector-container",children:[(0,l.jsx)(s,{size:18,style:{color:"var(--text-muted)",marginRight:"0.5rem"}}),(0,l.jsx)("select",{value:t,onChange:e=>a(e.target.value),className:"founder-select",children:i.$h.map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)(n,{size:14,style:{marginLeft:"0.5rem",opacity:.5}})]})]})}},21(e,t,a){a.d(t,{Ek:()=>c,J3:()=>h,LF:()=>m,vD:()=>u});var r=a(555),s=a(43),n=a(667),i=a(791),l=a(217),o=a(320);const d=()=>(0,n.rJ)(i.db,"artifacts",l.sZ,"public","data",l.LL),c=(e,t)=>{const[a,i]=(0,s.useState)(null),[l,o]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{if(!e)return i(null),void o(!1);const a=(0,n.P)(d(),(0,n._M)("founder","==",t),(0,n._M)("endTime","==",null),(0,n.AB)(1)),s=(0,n.aQ)(a,e=>{let t=null;if(!e.empty){var a;const s=e.docs[0];t=(0,r.A)((0,r.A)({id:s.id},s.data()),{},{startTime:null===(a=s.data().startTime)||void 0===a?void 0:a.toDate()})}i(t),o(!1)},e=>{console.error("Active entry error:",e),o(!1)});return()=>s()},[e,t]),{activeEntry:a,loading:l}},m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const a=(0,o.hi)(o._l.RECENT_ENTRIES),[i,l]=(0,s.useState)(a||[]),[c,m]=(0,s.useState)(!a);return(0,s.useEffect)(()=>{if(!e)return l([]),void m(!1);const s=(0,n.P)(d(),(0,n.My)("startTime","desc"),(0,n.AB)(t)),i=e=>{const t=e.docs.map(e=>{var t,a,s,n;const i=e.data({serverTimestamps:"estimate"});return(0,r.A)((0,r.A)({id:e.id},i),{},{startTime:null===(t=i.startTime)||void 0===t||null===(a=t.toDate())||void 0===a?void 0:a.toISOString(),endTime:null===(s=i.endTime)||void 0===s||null===(n=s.toDate())||void 0===n?void 0:n.toISOString()})}),a=t.map(e=>(0,r.A)((0,r.A)({},e),{},{startTime:e.startTime?new Date(e.startTime):null,endTime:e.endTime?new Date(e.endTime):null}));l(a),m(!1),(0,o.H$)(o._l.RECENT_ENTRIES,t)};a||(0,n.GG)(s).then(e=>{i(e)}).catch(e=>{console.error("Recent entries error:",e),m(!1)});const c=(0,n.aQ)(s,i,e=>{console.error("Recent entries snapshot error:",e)});return()=>c()},[e,t,a]),{entries:i,loading:c}},h=e=>{const t=(0,o.hi)(o._l.STATS),[a,r]=(0,s.useState)(t||{monthTotal:0,yearTotal:0,founderStats:{},activeCount:0}),[i,l]=(0,s.useState)(!t),c=(0,s.useRef)(!!t);return(0,s.useEffect)(()=>{if(!e)return void l(!1);const a=new Date,s=new Date(a.getFullYear(),a.getMonth(),1),i=new Date(a.getFullYear(),0,1),m=s.getTime(),h=e=>{let t=0,a=0,r=0;const s={};return e.forEach(e=>{var n,i;const l=e.data(),o=l.founder;if(!o)return;if(s[o]||(s[o]={month:0,year:0}),!l.endTime)return void r++;const d=null!==(n=l.startTime)&&void 0!==n&&n.seconds?1e3*l.startTime.seconds:0,c=(null!==(i=l.endTime)&&void 0!==i&&i.seconds?1e3*l.endTime.seconds:0)-d;a+=c,s[o].year+=c,d>=m&&(t+=c,s[o].month+=c)}),{monthTotal:t,yearTotal:a,founderStats:s,activeCount:r}},u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=[(0,n._M)("startTime",">=",n.Dc.fromDate(e))];return t&&a.push((0,n._M)("startTime","<",n.Dc.fromDate(t))),(0,n.P)(d(),...a)}(i),g=e=>{r(e),l(!1),c.current=!0,(0,o.H$)(o._l.STATS,e)};t||(0,n.GG)(u).then(e=>{g(h(e.docs))}).catch(e=>{console.error("Stats getDocs error:",e),l(!1)});const p=(0,n.aQ)(u,e=>{g(h(e.docs))},e=>{console.error("Stats snapshot error:",e)});return()=>p()},[e,t]),{stats:a,loading:i}},u=e=>{const t=(0,o.hi)("timesheets_all"),[a,i]=(0,s.useState)(()=>t?t.map(e=>(0,r.A)((0,r.A)({},e),{},{startTime:e.startTime?new Date(e.startTime):null,endTime:e.endTime?new Date(e.endTime):null})):[]),[l,c]=(0,s.useState)(!t),[m,h]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(!e)return i([]),void c(!1);const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=e.docs.map(e=>{var t,a,s,n;const i=e.data({serverTimestamps:"estimate"});return(0,r.A)((0,r.A)({id:e.id},i),{},{startTime:null===(t=i.startTime)||void 0===t||null===(a=t.toDate())||void 0===a?void 0:a.toISOString(),endTime:null===(s=i.endTime)||void 0===s||null===(n=s.toDate())||void 0===n?void 0:n.toISOString()})}),s=a.map(e=>(0,r.A)((0,r.A)({},e),{},{startTime:e.startTime?new Date(e.startTime):null,endTime:e.endTime?new Date(e.endTime):null}));i(s),c(!1),t?50===a.length&&h(!0):(h(!1),(0,o.H$)("timesheets_all",a))};if(!t){const e=(0,n.P)(d(),(0,n.My)("startTime","desc"),(0,n.AB)(50));(0,n.GG)(e).then(e=>{a(e,!0)}).catch(e=>{console.error("Timesheets getDocs error:",e),c(!1)})}const s=(0,n.P)(d(),(0,n.My)("startTime","desc")),l=(0,n.aQ)(s,e=>{a(e,!1)});return()=>l()},[e,t]),{entries:a,loading:l,loadingMore:m}}},320(e,t,a){a.d(t,{H$:()=>n,_l:()=>l,hi:()=>s});const r="foundertrack_",s=e=>{try{const t=localStorage.getItem(r+e);if(!t)return null;const{data:a,timestamp:s}=JSON.parse(t);return Date.now()-s>864e5?(localStorage.removeItem(r+e),null):a}catch(t){return console.warn("Cache read error:",t),null}},n=(e,t)=>{try{const a={data:t,timestamp:Date.now()};localStorage.setItem(r+e,JSON.stringify(a))}catch(a){console.warn("Cache write error:",a),i()}},i=()=>{try{const e=Object.keys(localStorage),t=e.filter(e=>e.startsWith(r)).map(e=>{try{const t=JSON.parse(localStorage.getItem(e));return{key:e,timestamp:(null===t||void 0===t?void 0:t.timestamp)||0}}catch(t){return{key:e,timestamp:0}}});t.sort((e,t)=>e.timestamp-t.timestamp);t.slice(0,Math.ceil(t.length/2)).forEach(e=>localStorage.removeItem(e.key))}catch(e){console.warn("Old cache clear error:",e)}},l={STATS:"dashboard_stats",RECENT_ENTRIES:"recent_entries",MEETING_STATS:"meeting_stats",ATTENDANCE_PREFIX:"attendance_"}},829(e,t,a){a.d(t,{IM:()=>n,Yq:()=>s,a3:()=>r});const r=e=>{if(!e&&0!==e)return"0h 0m";const t=Math.floor(e/6e4);if(0===t)return"< 1m";const a=Math.floor(t/60),r=t%60;return"".concat(a,"h ").concat(r,"m")},s=e=>e?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(e):"",n=e=>e?e.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?"},855(e,t,a){a.d(t,{A:()=>r});const r=(0,a(784).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},902(e,t,a){a.d(t,{Dashboard:()=>A});var r=a(43),s=a(667),n=a(791),i=a(21),l=a(11),o=a(88),d=a(784);const c=(0,d.A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),m=(0,d.A)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);var h=a(829),u=a(217),g=a(579);const p=(0,r.memo)(e=>{let{stats:t,loading:a}=e;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:"stat-card card animate-enter delay-100",children:(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"stat-icon-wrapper blue",children:(0,g.jsx)(o.A,{size:24})}),(0,g.jsx)("div",{className:"stat-label",children:"Total Hours (Month)"}),(0,g.jsx)("div",{className:"stat-value",children:a&&!t.monthTotal?(0,g.jsx)("span",{className:"skeleton-text",style:{width:"80px",display:"inline-block"}}):(0,h.a3)(t.monthTotal)})]})}),(0,g.jsx)("div",{className:"stat-card card animate-enter delay-200",children:(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"stat-icon-wrapper green",children:(0,g.jsx)(c,{size:24})}),(0,g.jsx)("div",{className:"stat-label",children:"Total Hours (Year)"}),(0,g.jsx)("div",{className:"stat-value",children:a&&!t.yearTotal?(0,g.jsx)("span",{className:"skeleton-text",style:{width:"80px",display:"inline-block"}}):(0,h.a3)(t.yearTotal)})]})}),(0,g.jsx)("div",{className:"stat-card card animate-enter delay-300",children:(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"stat-icon-wrapper purple",children:(0,g.jsx)(m,{size:24})}),(0,g.jsx)("div",{className:"stat-label",children:"Active Sessions"}),(0,g.jsx)("div",{className:"stat-value",children:a&&0===t.activeCount&&!localStorage.getItem("dashboard_stats_cache")?(0,g.jsx)("span",{className:"skeleton-text",style:{width:"40px",display:"inline-block"}}):t.activeCount})]})}),(0,g.jsxs)("div",{className:"breakdown-card card animate-enter delay-400",children:[(0,g.jsx)("h3",{style:{fontSize:"1rem",fontWeight:600,margin:"0 0 1rem 0"},children:"Yearly Breakdown"}),(0,g.jsx)("div",{className:"breakdown-list",children:u.$h.map(e=>{var r,s;return(0,g.jsxs)("div",{className:"breakdown-item",children:[(0,g.jsx)("span",{style:{fontSize:"0.85rem",fontWeight:500},children:(0,h.IM)(e)}),(0,g.jsx)("span",{style:{fontSize:"0.9rem",fontWeight:700,color:"var(--primary)"},children:!a||null!==(r=t.founderStats[e])&&void 0!==r&&r.year?(0,h.a3)((null===(s=t.founderStats[e])||void 0===s?void 0:s.year)||0):"-"})]},e)})})]})]})}),x=(0,d.A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),y=(0,d.A)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),v=(0,d.A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),f=(0,r.memo)(e=>{var t;let{activeEntry:a,activeLoading:s,onClockIn:n,onClockOut:i,onManualSubmit:l}=e;const[o,d]=(0,r.useState)(""),[c,m]=(0,r.useState)(""),[h,u]=(0,r.useState)(!1),[p,f]=(0,r.useState)((new Date).toISOString().split("T")[0]),[j,T]=(0,r.useState)("09:00"),[S,b]=(0,r.useState)("17:00"),[k,N]=(0,r.useState)(""),[w,A]=(0,r.useState)("");return(0,g.jsx)("div",{className:"timer-section card animate-slide-up delay-200",children:(0,g.jsxs)("div",{style:{padding:"2rem"},children:[(0,g.jsxs)("div",{className:"timer-header",children:[(0,g.jsx)("h2",{style:{margin:0,fontSize:"1.25rem"},children:h?"Log Past Work":"Current Session"}),(0,g.jsx)("button",{onClick:()=>u(!h),className:"mode-switch-btn",children:h?"Switch to Timer":"Switch to Manual Entry"})]}),h?(0,g.jsxs)("form",{onSubmit:e=>{e.preventDefault();l("Others"===k?w:k,p,j,S),u(!1),N(""),A("")},style:{display:"grid",gap:"1.5rem"},children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"input-label",children:"Task Description"}),(0,g.jsx)("input",{type:"text",list:"task-suggestions",value:k,onChange:e=>N(e.target.value),placeholder:"e.g., Q3 Financial Review",className:"task-input"}),"Others"===k&&(0,g.jsx)("input",{type:"text",value:w,onChange:e=>A(e.target.value),placeholder:"Specify task...",className:"task-input",style:{marginTop:"0.5rem"},autoFocus:!0})]}),(0,g.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem"},children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"input-label",children:"Date"}),(0,g.jsx)("input",{type:"date",value:p,onChange:e=>f(e.target.value),className:"custom-input"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"input-label",children:"Start"}),(0,g.jsx)("input",{type:"time",value:j,onChange:e=>T(e.target.value),className:"custom-input"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"input-label",children:"End"}),(0,g.jsx)("input",{type:"time",value:S,onChange:e=>b(e.target.value),className:"custom-input"})]})]}),(0,g.jsxs)("button",{type:"submit",className:"action-btn btn-primary",children:[(0,g.jsx)(x,{size:20})," Log Entry"]})]}):(0,g.jsxs)("div",{className:"timer-controls",children:[(0,g.jsx)("div",{style:{flex:1},children:a?(0,g.jsxs)("div",{className:"active-session-card",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{style:{fontSize:"0.8rem",textTransform:"uppercase",color:"var(--primary)",fontWeight:700,marginBottom:"0.25rem"},children:"Active Task"}),(0,g.jsx)("div",{style:{fontSize:"1.1rem",fontWeight:600},children:a.task}),(0,g.jsxs)("div",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:["Started at ",null===(t=a.startTime)||void 0===t?void 0:t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),(0,g.jsx)("div",{className:"btn-pulse",style:{width:"12px",height:"12px",background:"#10b981",borderRadius:"50%"}})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("input",{type:"text",list:"task-suggestions",value:o,onChange:e=>d(e.target.value),placeholder:"What are you working on?",className:"task-input"}),"Others"===o&&(0,g.jsx)("input",{type:"text",value:c,onChange:e=>m(e.target.value),placeholder:"Specify task...",className:"task-input",style:{marginTop:"0.75rem"},autoFocus:!0})]})}),a?(0,g.jsxs)("button",{onClick:i,className:"action-btn btn-danger",children:[(0,g.jsx)(y,{size:20,fill:"currentColor"})," Stop"]}):(0,g.jsxs)("button",{onClick:()=>{n("Others"===o?c:o),d(""),m("")},disabled:s&&!a&&!1,className:"action-btn btn-primary",children:[(0,g.jsx)(v,{size:20,fill:"currentColor"})," Start"]})]})]})})});var j=a(978),T=a(855);const S=(0,r.memo)(e=>{let{entries:t,loading:a,onDelete:r}=e;return(0,g.jsxs)("div",{className:"card history-section animate-slide-up delay-300",children:[(0,g.jsxs)("h3",{style:{fontSize:"1.1rem",margin:"0 0 1.5rem 0",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,g.jsx)(j.A,{size:20})," Recent Activity (Last 10)"]}),0===t.length?(0,g.jsx)("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:a?"Checking history...":"No activities recorded yet."}):(0,g.jsx)("ul",{className:"history-list",children:t.map(e=>{const t=e.endTime?(0,h.a3)(e.endTime-e.startTime):"Active",a=(0,h.IM)(e.founder),s=["#4361ee","#7209b7","#f72585","#4cc9f0"][u.$h.indexOf(e.founder)%4];return(0,g.jsxs)("li",{className:"history-item",children:[(0,g.jsx)("div",{className:"history-avatar",style:{background:"".concat(s,"20"),color:s},children:a}),(0,g.jsxs)("div",{className:"history-content",children:[(0,g.jsx)("div",{className:"history-task",children:e.task}),(0,g.jsxs)("div",{className:"history-meta",children:[(0,g.jsx)("span",{children:e.founder}),(0,g.jsx)("span",{children:"\u2022"}),(0,g.jsx)("span",{children:(0,h.Yq)(e.startTime)}),(0,g.jsx)("span",{children:"\u2022"}),(0,g.jsxs)("span",{children:[e.startTime&&e.startTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",e.endTime?e.endTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Now"]})]})]}),(0,g.jsx)("span",{className:"history-duration",style:e.endTime?{}:{color:"#10b981",background:"#d1fae5"},children:t}),(0,g.jsx)("button",{onClick:()=>r(e.id),className:"history-delete-btn",title:"Delete",children:(0,g.jsx)(T.A,{size:16})})]},e.id)})})]})});var b=a(555),k=a(320);const N=()=>u.$h.reduce((e,t)=>(0,b.A)((0,b.A)({},e),{},{[t]:!1}),{}),w=r.memo(()=>{const[e,t]=(0,r.useState)((new Date).toISOString().split("T")[0]),a=(new Date).toISOString().split("T")[0],i=(0,k.hi)(k._l.ATTENDANCE_PREFIX+a),[l,o]=(0,r.useState)(i||N()),[d,c]=(0,r.useState)(i||N()),[m,h]=(0,r.useState)(!i),[p,x]=(0,r.useState)(!i||e!==a),[y,v]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!1),T=(0,k.hi)(k._l.MEETING_STATS),[S,w]=(0,r.useState)(T||{founderStats:{},yearlyTotal:0,totalMeetings:0}),A=(0,r.useRef)(new Set);(0,r.useEffect)(()=>{let t=!1;return(async()=>{const a=(0,k.hi)(k._l.ATTENDANCE_PREFIX+e);a?(o(a),c(a),h(!1),x(!1),A.current.add(e)):x(!0),j(!1);try{const r=(0,s.H9)(n.db,"artifacts",u.sZ,"public","data","meeting_attendance",e),i=await(0,s.x7)(r);if(t)return;if(i.exists()){const t=i.data().attendance||{},a=(0,b.A)((0,b.A)({},N()),t);o(a),c(a),h(!1),A.current.add(e),(0,k.H$)(k._l.ATTENDANCE_PREFIX+e,a)}else if(!a){const e=N();o(e),c(e),h(!0)}}catch(r){if(console.error("Error fetching attendance:",r),!a){const e=N();o(e),c(e),h(!0)}}finally{t||x(!1)}})(),()=>{t=!0}},[e]),(0,r.useEffect)(()=>{(async()=>{try{const e=(0,s.P)((0,s.rJ)(n.db,"artifacts",u.sZ,"public","data","meeting_attendance"),(0,s.My)("date","desc")),t=await(0,s.GG)(e),a=u.$h.reduce((e,t)=>(0,b.A)((0,b.A)({},e),{},{[t]:0}),{});let r=0,i=0;const l=(new Date).getFullYear();t.forEach(e=>{const t=e.data(),s=new Date(t.date);i++,s.getFullYear()===l&&r++,t.attendance&&Object.entries(t.attendance).forEach(e=>{let[t,r]=e;r&&void 0!==a[t]&&a[t]++})});const o={founderStats:a,yearlyTotal:r,totalMeetings:i};w(o),(0,k.H$)(k._l.MEETING_STATS,o)}catch(e){console.error("Error fetching stats:",e)}})()},[]);return(0,g.jsxs)("div",{className:"card meeting-attendance-card",style:{gridColumn:"span 12"},children:[(0,g.jsxs)("div",{className:"timer-header",children:[(0,g.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:700,margin:0},children:"Founders Weekly Meeting"}),(0,g.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[(0,g.jsx)("label",{className:"date-display",children:"Select Date:"}),(0,g.jsx)("input",{type:"date",value:e,onChange:e=>t(e.target.value),className:"custom-input",style:{padding:"0.5rem",width:"auto"}})]})]}),(0,g.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginTop:"1.5rem"},children:[(0,g.jsxs)("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"12px"},children:[(0,g.jsxs)("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px"},children:["Mark Attendance",m&&!p&&(0,g.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.75rem",color:"#f59e0b",fontWeight:400},children:"(New Meeting)"})]}),p?(0,g.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"Loading attendance..."}):(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:u.$h.map(e=>(0,g.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"1rem",cursor:"pointer",padding:"0.75rem",background:l[e]?"rgba(16, 185, 129, 0.1)":"white",borderRadius:"8px",border:l[e]?"1px solid #10b981":"1px solid var(--border-color)",transition:"all 0.2s ease"},children:[(0,g.jsx)("input",{type:"checkbox",checked:l[e]||!1,onChange:()=>(e=>{o(t=>(0,b.A)((0,b.A)({},t),{},{[e]:!t[e]}))})(e),style:{width:"1.2rem",height:"1.2rem",accentColor:"#10b981"}}),(0,g.jsx)("span",{style:{fontWeight:500},children:e})]},e))}),(0,g.jsx)("div",{style:{marginTop:"1.5rem"},children:(0,g.jsx)("button",{onClick:async()=>{v(!0),j(!1);try{const a=(new Date).getFullYear(),r=new Date(e).getFullYear()===a,i=m;w(e=>{const t=(0,b.A)({},e),a=(0,b.A)({},e.founderStats);return i&&(t.totalMeetings+=1,r&&(t.yearlyTotal+=1)),u.$h.forEach(e=>{const t=d[e]||!1,r=l[e]||!1;r&&!t?a[e]=(a[e]||0)+1:!r&&t&&(a[e]=Math.max(0,(a[e]||0)-1))}),t.founderStats=a,t});const o=(0,s.H9)(n.db,"artifacts",u.sZ,"public","data","meeting_attendance",e),g={date:e,attendance:l,updatedAt:(new Date).toISOString()},p=(0,s.BN)(o,g,{merge:!0}),x=new Promise((e,t)=>setTimeout(()=>t(new Error("timeout")),8e3));try{await Promise.race([p,x])}catch(t){console.warn("Save timed out, but data may still sync later:",t)}c((0,b.A)({},l)),h(!1),A.current.add(e),j(!0),(0,k.H$)(k._l.ATTENDANCE_PREFIX+e,l),setTimeout(()=>j(!1),3e3)}catch(a){console.error("Error saving attendance:",a),alert("Failed to save attendance. Please try again.")}finally{v(!1)}},disabled:y||p,style:{width:"100%",padding:"1rem",borderRadius:"12px",border:"none",fontWeight:700,fontSize:"1rem",cursor:y||p?"not-allowed":"pointer",background:f?"#10b981":y?"#6b7280":"var(--primary)",color:"white",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:y?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("span",{style:{width:"16px",height:"16px",border:"2px solid white",borderTopColor:"transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"Saving..."]}):f?(0,g.jsx)(g.Fragment,{children:"\u2713 Saved!"}):"Save Attendance"})})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Attendance Overview"}),(0,g.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[(0,g.jsxs)("div",{style:{background:"rgba(67, 97, 238, 0.05)",padding:"1rem",borderRadius:"12px"},children:[(0,g.jsx)("div",{style:{fontSize:"0.8rem",color:"var(--primary)",fontWeight:600},children:"Total Meetings (Year)"}),(0,g.jsx)("div",{style:{fontSize:"1.8rem",fontWeight:700,color:"var(--text-main)"},children:S.yearlyTotal})]}),(0,g.jsxs)("div",{style:{background:"rgba(16, 185, 129, 0.05)",padding:"1rem",borderRadius:"12px"},children:[(0,g.jsx)("div",{style:{fontSize:"0.8rem",color:"#10b981",fontWeight:600},children:"Total Meetings (All Time)"}),(0,g.jsx)("div",{style:{fontSize:"1.8rem",fontWeight:700,color:"var(--text-main)"},children:S.totalMeetings})]})]}),(0,g.jsx)("div",{style:{background:"white",border:"1px solid var(--border-color)",borderRadius:"12px",overflow:"hidden"},children:(0,g.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{style:{background:"#f8f9fa",borderBottom:"1px solid var(--border-color)"},children:[(0,g.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left",fontSize:"0.85rem",color:"var(--text-muted)"},children:"Founder"}),(0,g.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"right",fontSize:"0.85rem",color:"var(--text-muted)"},children:"Attended"}),(0,g.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"right",fontSize:"0.85rem",color:"var(--text-muted)"},children:"Rate"})]})}),(0,g.jsx)("tbody",{children:u.$h.map((e,t)=>{const a=S.founderStats[e]||0,r=S.totalMeetings||1,s=Math.round(a/r*100);return(0,g.jsxs)("tr",{style:{borderBottom:t===u.$h.length-1?"none":"1px solid var(--border-color)"},children:[(0,g.jsx)("td",{style:{padding:"0.75rem 1rem",fontWeight:500},children:e}),(0,g.jsx)("td",{style:{padding:"0.75rem 1rem",textAlign:"right",fontWeight:600},children:a}),(0,g.jsx)("td",{style:{padding:"0.75rem 1rem",textAlign:"right"},children:(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"0.5rem"},children:[(0,g.jsxs)("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:[s,"%"]}),(0,g.jsx)("div",{style:{width:"40px",height:"4px",background:"#e9ecef",borderRadius:"2px",overflow:"hidden"},children:(0,g.jsx)("div",{style:{width:"".concat(s,"%"),height:"100%",background:"var(--primary)"}})})]})})]},e)})})]})})]})]}),(0,g.jsx)("style",{children:"\n                @keyframes spin {\n                    to { transform: rotate(360deg); }\n                }\n            "})]})}),A=e=>{let{user:t}=e;const[a,o]=(0,r.useState)(u.$h[0]),{activeEntry:d,loading:c}=(0,i.Ek)(t,a),{entries:m,loading:h}=(0,i.LF)(t,10),{stats:x,loading:y}=(0,i.J3)(t),v=(0,r.useCallback)(async e=>{if(t&&e.trim())try{await(0,s.gS)((0,s.rJ)(n.db,"artifacts",u.sZ,"public","data",u.LL),{founder:a,task:e,startTime:(0,s.O5)(),endTime:null,status:"active"})}catch(r){console.error("Error clocking in:",r)}},[t,a]),j=(0,r.useCallback)(async()=>{if(t&&d)try{const e=(0,s.H9)(n.db,"artifacts",u.sZ,"public","data",u.LL,d.id);await(0,s.mZ)(e,{endTime:(0,s.O5)(),status:"completed"})}catch(e){console.error("Error clocking out:",e)}},[t,d]),T=(0,r.useCallback)(async(e,r,i,l)=>{if(!t||!e.trim())return;const o=new Date("".concat(r,"T").concat(i)),d=new Date("".concat(r,"T").concat(l));if(d<=o)alert("End time must be after start time");else try{await(0,s.gS)((0,s.rJ)(n.db,"artifacts",u.sZ,"public","data",u.LL),{founder:a,task:e,startTime:s.Dc.fromDate(o),endTime:s.Dc.fromDate(d),status:"manual"})}catch(c){console.error("Error adding manual entry:",c)}},[t,a]),b=(0,r.useCallback)(async e=>{if(window.confirm("Are you sure you want to delete this entry?"))try{await(0,s.kd)((0,s.H9)(n.db,"artifacts",u.sZ,"public","data",u.LL,e))}catch(t){console.error("Error deleting:",t)}},[]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("datalist",{id:"task-suggestions",children:u.Ct.map(e=>(0,g.jsx)("option",{value:e},e))}),(0,g.jsx)(l.V,{selectedFounder:a,setSelectedFounder:o,title:"Timesheet Dashboard"}),(0,g.jsxs)("div",{className:"dashboard-grid",children:[(0,g.jsx)(p,{stats:x,loading:y}),(0,g.jsx)(f,{activeEntry:d,activeLoading:c,onClockIn:v,onClockOut:j,onManualSubmit:T}),(0,g.jsx)(w,{}),(0,g.jsx)(S,{entries:m,loading:h,onDelete:b})]})]})}}}]);
//# sourceMappingURL=902.b7fbdb24.chunk.js.map