{"version":3,"file":"static/js/78.b8557b9e.chunk.js","mappings":"8KAKO,MAAMA,EAAgBA,KACzB,MAAOC,EAAQC,IAAaC,EAAAA,EAAAA,UAAS,KAC9BC,EAASC,IAAcF,EAAAA,EAAAA,WAAS,IAChCG,EAAUC,IAAeJ,EAAAA,EAAAA,UAAS,IAoEzC,OACIK,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEC,QAAS,OAAQC,SAAU,QAASC,OAAQ,SAAUC,UAAW,UAAWC,SAAA,EACtFC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,uBACJC,EAAAA,EAAAA,KAAA,KAAGN,MAAO,CAAEO,MAAO,MAAOC,WAAY,QAASH,SAAC,uDAEhDN,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEG,OAAQ,UAAWE,SAAA,EAC7BC,EAAAA,EAAAA,KAAA,SACIG,KAAK,WACLC,YAAY,uBACZC,MAAOd,EACPe,SAAUC,GAAKf,EAAYe,EAAEC,OAAOH,OACpCX,MAAO,CAAEC,QAAS,SAAUc,YAAa,WAE7CT,EAAAA,EAAAA,KAAA,UACIU,QAhFQC,UACpB,GAAiB,WAAbpB,GAKJ,GAAKqB,OAAOC,QAAQ,0IAApB,CAEAvB,GAAW,GACXH,EAAU,uBAEV,IAEI,MAAM2B,EAAmBH,UACrB,MAAMI,GAASC,EAAAA,EAAAA,IAAWC,EAAAA,MAAOC,GAC3BC,QAAiBC,EAAAA,EAAAA,IAAQL,GAE/B,IAAIM,GAAQC,EAAAA,EAAAA,IAAWL,EAAAA,IACnBM,EAAQ,EACRC,EAAe,EAEnBrC,EAAU,SAADsC,OAAUN,EAASO,KAAI,kBAAAD,OAAiBP,EAAaA,EAAaS,OAAS,GAAE,QAEtF,IAAK,MAAMC,KAAeT,EAASU,KAC/BR,EAAMS,OAAOF,EAAYG,KACzBR,IACIA,GAVU,YAWJF,EAAMW,SACZR,GAAgBD,EAChBF,GAAQC,EAAAA,EAAAA,IAAWL,EAAAA,IACnBM,EAAQ,GAGZA,EAAQ,UACFF,EAAMW,SACZR,GAAgBD,GAEpBpC,EAAU8C,GAAQA,EAAI,YAAAR,OAAeD,EAAY,oBAAAC,OAAmBP,EAAaA,EAAaS,OAAS,GAAE,cAIvGb,EAAiB,CAAC,YAAaoB,EAAAA,GAAQ,SAAU,OAAQ,qBAGzDpB,EAAiB,CAAC,YAAaoB,EAAAA,GAAQ,SAAU,OAAQ,6BAIzDC,EAAAA,EAAAA,KAAUC,EAAAA,EAAAA,IAAInB,EAAAA,GAAI,YAAaiB,EAAAA,GAAQ,SAAU,OAAQ,QAAS,cACxE/C,EAAU8C,GAAQA,EAAO,wBAKnBnB,EAAiB,CAAC,YAAaoB,EAAAA,GAAQ,UAE7C/C,EAAU8C,GAAQA,EAAO,2BAE7B,CAAE,MAAOI,GACLC,QAAQD,MAAMA,GACdlD,EAAU,UAADsC,OAAWY,EAAME,SAC9B,CAAC,QACGjD,GAAW,EACf,CAzDqK,OAJjKH,EAAU,uBA+EFqD,SAAUnD,EACVK,MAAO,CACHC,QAAS,cACT8C,WAAY,MACZxC,MAAO,QACPyC,OAAQ,OACRC,OAAQ,WACV5C,SAEDV,EAAU,cAAgB,sBAInCW,EAAAA,EAAAA,KAAA,OAAKN,MAAO,CAAEkD,UAAW,OAAQC,WAAY,WAAY/C,UAAW,OAAQ2C,WAAY,OAAQ9C,QAAS,QAASI,SAC7Gb,O","sources":["pages/ResetDataTool.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { collection, getDocs, deleteDoc, doc, writeBatch } from 'firebase/firestore';\nimport { db } from '../firebase';\nimport { APP_ID } from '../constants';\n\nexport const ResetDataTool = () => {\n    const [status, setStatus] = useState('');\n    const [loading, setLoading] = useState(false);\n    const [password, setPassword] = useState('');\n\n    const handleClearData = async () => {\n        if (password !== '097756') { // Simple protection\n            setStatus('Incorrect Password');\n            return;\n        }\n\n        if (!window.confirm(\"WARNING: This will delete ALL application data (Timesheets, Meetings, Stats). Users will remain but their data will be gone. Continue?\")) return;\n\n        setLoading(true);\n        setStatus('Starting cleanup...');\n\n        try {\n            // Helper to delete collections in batches\n            const deleteCollection = async (pathSegments) => {\n                const colRef = collection(db, ...pathSegments);\n                const snapshot = await getDocs(colRef);\n                const batchSize = 500;\n                let batch = writeBatch(db);\n                let count = 0;\n                let totalDeleted = 0;\n\n                setStatus(`Found ${snapshot.size} documents in ${pathSegments[pathSegments.length - 1]}...`);\n\n                for (const docSnapshot of snapshot.docs) {\n                    batch.delete(docSnapshot.ref);\n                    count++;\n                    if (count >= batchSize) {\n                        await batch.commit();\n                        totalDeleted += count;\n                        batch = writeBatch(db);\n                        count = 0;\n                    }\n                }\n                if (count > 0) {\n                    await batch.commit();\n                    totalDeleted += count;\n                }\n                setStatus(prev => prev + ` Deleted ${totalDeleted} documents from ${pathSegments[pathSegments.length - 1]}. `);\n            };\n\n            // 1. Clear Timesheets\n            await deleteCollection(['artifacts', APP_ID, 'public', 'data', 'timesheets']);\n\n            // 2. Clear Meetings\n            await deleteCollection(['artifacts', APP_ID, 'public', 'data', 'meeting_attendance']);\n\n            // 3. Clear Stats (Aggregate)\n            // It's a single doc\n            await deleteDoc(doc(db, 'artifacts', APP_ID, 'public', 'data', 'stats', 'aggregate'));\n            setStatus(prev => prev + \" Stats reset. \");\n\n            // 4. Clear Users (Optional - User asked for \"Fresh\")\n            // If we clear users, we force re-signup logic.\n            // Let's DO IT to be thorough.\n            await deleteCollection(['artifacts', APP_ID, 'users']);\n\n            setStatus(prev => prev + \" DONE. All data cleared.\");\n\n        } catch (error) {\n            console.error(error);\n            setStatus(`Error: ${error.message}`);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div style={{ padding: '2rem', maxWidth: '600px', margin: '0 auto', textAlign: 'center' }}>\n            <h1>System Reset Tool</h1>\n            <p style={{ color: 'red', fontWeight: 'bold' }}>DANGER ZONE: This permanently wipes the database.</p>\n\n            <div style={{ margin: '2rem 0' }}>\n                <input\n                    type=\"password\"\n                    placeholder=\"Enter Admin Password\"\n                    value={password}\n                    onChange={e => setPassword(e.target.value)}\n                    style={{ padding: '0.5rem', marginRight: '1rem' }}\n                />\n                <button\n                    onClick={handleClearData}\n                    disabled={loading}\n                    style={{\n                        padding: '0.5rem 1rem',\n                        background: 'red',\n                        color: 'white',\n                        border: 'none',\n                        cursor: 'pointer'\n                    }}\n                >\n                    {loading ? 'Clearing...' : 'NUKE DATABASE'}\n                </button>\n            </div>\n\n            <div style={{ marginTop: '2rem', whiteSpace: 'pre-wrap', textAlign: 'left', background: '#eee', padding: '1rem' }}>\n                {status}\n            </div>\n        </div>\n    );\n};\n"],"names":["ResetDataTool","status","setStatus","useState","loading","setLoading","password","setPassword","_jsxs","style","padding","maxWidth","margin","textAlign","children","_jsx","color","fontWeight","type","placeholder","value","onChange","e","target","marginRight","onClick","async","window","confirm","deleteCollection","colRef","collection","db","pathSegments","snapshot","getDocs","batch","writeBatch","count","totalDeleted","concat","size","length","docSnapshot","docs","delete","ref","commit","prev","APP_ID","deleteDoc","doc","error","console","message","disabled","background","border","cursor","marginTop","whiteSpace"],"ignoreList":[],"sourceRoot":""}